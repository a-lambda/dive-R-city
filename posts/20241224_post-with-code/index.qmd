---
title: "List files without directory part"
author: "Alcor"
date: "2024-12-24"
categories: [news, code, analysis]
image: "image.jpg"
---

Get the list of files recursively from a directory (without the folder part in the filename if it does exist)

```{r}
#| label: load_libraries
#| code-fold: true

library(stringi) # stri_split_fixed
library(purrr)   # map
library(microbenchmark)

```

### `list_of_files` function 

```{r}
#| label: list_of_files

list_of_files <- function(path, ...) {
  
  return(
    list.files(path = path, ...) |>
      map(\(x) { sub(x, pattern = "^(.*)/", replacement = '') }) |> 
      unlist()
  )
  
}

#---------------------------------------------------------------------------
# 1st version
# -----------
# list.files(path = path, ...) |>
#   map(\(x) { stri_split_fixed(x, "/")[[1]] |> tail(n = 1) }) |> 
#   unlist()
#---------------------------------------------------------------------------
# 2nd version
# -----------
# list.files(path = path, ...) |>
#   map(\(x) { stri_match_all_regex(x, pattern = "/([^/]*)$")[[1]][,2] }) |> 
#   unlist())
#---------------------------------------------------------------------------

```

### benchmarking comparisons

```{r}
#| label: benchmarks
#| code-fold: true

dir_test <- getwd()

microbenchmark(
  list.files(path = dir_test, recursive = TRUE),
  list_of_files(path = dir_test, recursive = TRUE)
) |> 
  ggplot2::autoplot()

```

### results when applying

```{r}
#| label: list_files_results

list.files(path = "../", recursive = TRUE) |> tail(n = 10)
list_of_files(path = "../", recursive = TRUE) |>  tail(n = 10)

```



